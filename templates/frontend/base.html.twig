<html lang="en">
<head>
    <title>{% block title %}Welcome to Kuba-reisen!{% endblock %}</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block metadescription %}Kuba-reisen: get your next travel to Cuba{% endblock %}">
    <link href="https://fonts.googleapis.com/css?family=Baloo+Bhaina|Open+Sans" rel="stylesheet">
    <!-- Icons -->
    <link rel="shortcut icon" type="image/ico" href="{{ asset('dist/favicon.ico') }}">

    <!-- Stylesheet -->

    {% if is_granted('ROLE_EDITOR') and not app.request.get('preview') %}
        <link rel="stylesheet" href="{{ asset('styles/kraken_backend.css') }}" type="text/css">
        {#<link rel="stylesheet" href="{{ asset('styles/all_backend_css.css') }}" type="text/css">#}
    {% else %}
        <link rel="stylesheet" href="{{ asset('styles/kraken.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('styles/styles.css') }}" type="text/css">
    {% endif %}

    {% block stylesheets %}{% endblock %}

    </head>

    <body {% if is_granted('ROLE_EDITOR') and not app.request.get('preview') %}class="admin-logged"{% endif %}>

        {{ include('frontend/components/global/_icons.html.twig') }}

        {% if is_granted('ROLE_EDITOR') and not app.request.get('preview') %}
            {{ include('backend/adminbar/admin_bar.html.twig') }}
        {% endif %}

        {% if is_granted('ROLE_EDITOR') and not app.request.get('preview')  %}
            <div id="grapes-editable">
        {% endif %}

            {{ render(controller('App\\Controller\\RegionsController::regionHeader'), {'preview':app.request.get('preview')} ) }}

            {% block body %}{% endblock %}

            {% if not is_granted('ROLE_EDITOR') or app.request.get('preview') %}
                {{  include('frontend/components/global/_cart_bar.html.twig') }}
            {% endif %}
                
            {{ render(controller('App\\Controller\\RegionsController::regionFooter')) }}

        {% if is_granted('ROLE_EDITOR') and not app.request.get('preview') %}
            </div>
        {% endif %}

        {% if is_granted('ROLE_EDITOR') and not app.request.get('preview') %}
            <script>
                //APP_ROUTES & PARAMS
                var app_js_param__csrf_token = "{{ csrf_token('_grapejs_editor_token') }}"
                var app_js_routing__styles_css = "{{ absolute_url(asset('styles/all_backend_css.css')) }}"
                var app_js_routing__grape_endpoint = "{{ absolute_url(path('endpoint')) }}"
                var app_js_routing__grape_endpoint_upload = "{{ absolute_url(path('endpoint_upload_assets')) }}"
                var app_js_param__page_id = {% if dynamic_page_id is defined %}"{{ dynamic_page_id }}"{% else %}-1;{% endif %}
            </script>
            <script src="{{ asset('scripts/app_backend.js') }}"></script>
        {% else %}
                {% block javascripts_vendors %}{% endblock %}
                {% block javascripts %}{% endblock %}

                <script>
                    var _url_activitiesApi = '{{ url('getActivities') }}';
                </script>
                <script src="{{ asset('scripts/app.js') }}"></script>
        {% endif %}

    </body>
</html>